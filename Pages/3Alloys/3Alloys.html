<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#12151e">
  <title>TFC Ratios</title>
  <meta name="description" content="Interactive calculators for TerraFirmaCraft early game efficiency ratios - Bloomery and Alloy optimization">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <link href="./3Alloys.css" rel="stylesheet">
  <link href="../Styles/base.css" rel="stylesheet">
  <link href="../Styles/navbar.css" rel="stylesheet">
  <link href="../Styles/items.css" rel="stylesheet">
  
  
  <script src="https://www.desmos.com/api/v1.8/calculator.js?apiKey=dcb31709b452b1cf9dc26972add0fda6"></script>
  <script src="../routing.js"></script>
  <script src="3Alloys.js"></script>
</head>
<body>

  <!-- ==================== NAVIGATION ==================== -->
  <nav id="nav" class="nav">
    <button class="nav-back" onclick="showView('menu')">
      <svg viewBox="0 0 16 16" fill="none"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
      Back to Menu
    </button>
    <div class="nav-divider"></div>
    <button id="nav-bloomery" class="nav-link" onclick="showView('Bloomery')">Bloomery</button>
    <button id="nav-alloys" class="nav-link">Alloys</button>
  </nav>

  <section id="view-alloys" class="page">
    <div class="alloy-full">
      <header class="page-header">
        <h1>Alloys Calculator</h1>
        <p>Define up to 3 minerals, each with custom coefficients. Use presets or add your own values, then calculate to find optimal points.</p>
      </header>

      <!-- 3-Column Mineral Definition -->
      <div id="alloys-minerals" class="minerals-grid"></div>
      
      <div style="display: flex; justify-content: center; margin-top: 1rem;">
        <button id="add-mineral-btn" class="btn-xs" style="padding: 8px 16px;" onclick="alloysAddMineral()">+ Add Mineral</button>
      </div>

      <div class="calc-bar hidden" id="ratios-warning">
        
      </div>
      <!-- Calculate Bar -->
      <div class="calc-bar">
        <button id="alloy-calc-btn" class="btn-calc" onclick="alloysCalculate()">
          <svg viewBox="0 0 20 20" fill="none"><path d="M10 2L18 18H2L10 2Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/><circle cx="10" cy="12" r="2" fill="currentColor"/></svg>
          Calculate
        </button>
      </div>

      <!-- Results: Highlights (Top 3 Max + Min) -->
      <div id="alloy-results-wrap" class="results-section hidden">
        <div id="alloy-highlights" class="results-highlights"></div>

        <!-- Expandable All-Points Table -->
        <div class="expandable-section">
          <button class="expandable-toggle" id="alloy-table-toggle" onclick="toggleAlloyTable()">
            <span>All Calculated Points</span>
            <div class="expandable-toggle-right">
              <span id="alloy-points-count">0 points</span>
              <svg viewBox="0 0 16 16" fill="none"><path d="M4 6L8 10L12 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
            </div>
          </button>
          <div class="expandable-body" id="alloy-table-body">
            <table class="data-table" id="alloy-data-table"></table>
          </div>
        </div>

        <!-- Graph Container -->
        <div class="graph-container">
          <h2>Graph</h2>
          <div class="graph-placeholder" id="alloy-graph">
            <div id="calculator" style="width: 100%; height: 500px; margin-top: 20px; border: 1px solid #ccc;" class="hidden"></div>
            <div id="ternary" style="width: 100%; height: 500px; margin-top: 20px; border: 1px solid #ccc;" class="hidden"></div>
          </div>
            
        </div>
      </div>

      <!-- Analysis -->
      <!-- <div class="card analysis-section">
        <h2 class="card-title">Analysis</h2>
        <p class="card-desc">Write your observations and analysis below.</p>
        <textarea id="alloys-analysis" placeholder="Write your alloy analysis here..." rows="8"></textarea>
      </div> -->
    </div>
</section>

</body>
</html>
